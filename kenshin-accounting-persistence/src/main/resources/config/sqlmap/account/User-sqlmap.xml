<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="User">

	<typeAlias alias="User" type="com.gtt.accounting.persistence.entity.User" />
	
	<resultMap id="simpleResult" class="User">
		<result column="id" property="id"/>
		<result column="username" property="username"/>
		<result column="password" property="password"/>
		<result column="email" property="email"/>
		<result column="status" property="status"/>
		<result column="created" property="created"/>
		<result column="lastModified" property="lastModified"/>
	</resultMap>	 
	
	<insert id="insert" parameterClass="map">
		INSERT INTO Act_User
			(username, password, email, status, created, lastModified)
		VALUES
			(#username#, #password#, #email#, 1, NOW(), NOW())
		<selectKey resultClass="long" keyProperty="id" >     
       		SELECT @@IDENTITY AS id  
       	</selectKey>
	</insert>
	
	<select id="loadById" resultMap="simpleResult" parameterClass="map">
		SELECT id, username, password, email, status, created, lastModified
		FROM Act_User
		WHERE status=1 AND id=#id#
	</select>

	<select id="loadByUsername" resultMap="simpleResult" parameterClass="map">
		SELECT id, username, password, email, status, created, lastModified
		FROM Act_User
		WHERE status=1 AND username=#username#
	</select>
	
	<update id="update" parameterClass="map">
		UPDATE Act_User
		SET password=#password#, email=#email#, status=#status#, lastModified=NOW()
		WHERE id=#id#
	</update>
	
	<delete id="delete" parameterClass="map">
		UPDATE Act_User
		SET status=0, lastModified=NOW()
		WHERE id=#id#
	</delete>
	
</sqlMap>